<!DOCTYPE html>
<html>
<head>
    <title>Vocab Manager</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f4f6f8;
            padding: 30px;
            color: #333;
            margin: 0;
        }

        h2 {
            color: #2c3e50;
            text-align: center;
            font-size: 26px;
        }

        label {
            font-weight: bold;
            margin-right: 10px;
            font-size: 16px;
        }

        select, input[type="text"] {
            padding: 12px 16px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 16px;
            width: 100%;
            box-sizing: border-box;
        }

        input[type="text"] {
            width: calc(100% - 20px);
        }

        button {
            padding: 12px 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            width: 100%;
            margin-top: 15px;
        }

        button:hover {
            background-color: #2980b9;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .section {
            margin-top: 30px;
        }

        .container {
            background: #ffffff;
            border-radius: 10px;
            padding: 30px;
            max-width: 800px;
            margin: auto;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        #resultList {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 0;
            margin-top: 15px;
        }

        #resultList li {
            list-style: none;
            background-color: #ffffff;
            border: 1px solid #ddd;
            padding: 10px 14px;
            border-radius: 20px;
            font-size: 16px;
            display: flex;
            align-items: center;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .word-text {
            cursor: pointer;
            margin-right: 12px;
            font-size: 16px;
        }

        .delete-btn {
            color: red;
            cursor: pointer;
            font-size: 18px;
        }

        /* Mobile responsiveness */
        @@media screen and (max-width: 768px) {
            .container {
                padding: 20px;
            }

            button {
                width: 100%;
                padding: 15px;
                font-size: 18px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            label, select, input[type="text"] {
                font-size: 18px;
            }

            h2 {
                font-size: 24px;
                margin-bottom: 20px;
            }

            #resultList li {
                font-size: 16px;
                width: 48%; /* 2 items per row */
                margin-bottom: 10px;
            }
        }

        @@media screen and (max-width: 480px) {
            h2 {
                font-size: 22px;
            }

            #resultList li {
                font-size: 18px;
                width: 100%; /* 1 item per row */
            }

            button {
                padding: 16px;
                font-size: 20px;
            }

            label, select, input[type="text"] {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>ðŸ“š Vocab Manager</h2>

        <div class="form-group">
            <select id="category">
                <option value="vocab">Vocab</option>
                <option value="idioms">Idioms</option>
                <option value="ows">OWS</option>
            </select>
            <select id="alphabet">
                <option value="A">A</option>
                <option value="B">B</option>
                <option value="C">C</option>
                <option value="D">D</option>
                <option value="E">E</option>
                <option value="F">F</option>
                <option value="G">G</option>
                <option value="H">H</option>
                <option value="I">I</option>
                <option value="J">J</option>
                <option value="K">K</option>
                <option value="L">L</option>
                <option value="M">M</option>
                <option value="N">N</option>
                <option value="O">O</option>
                <option value="P">P</option>
                <option value="Q">Q</option>
                <option value="R">R</option>
                <option value="S">S</option>
                <option value="T">T</option>
                <option value="U">U</option>
                <option value="V">V</option>
                <option value="W">W</option>
                <option value="X">X</option>
                <option value="Y">Y</option>
                <option value="Z">Z</option>

            </select>
        </div>

        <div class="form-group">
            <input type="text" id="wordInput" placeholder="Enter word or phrase" />
            <button onclick="addEntry()">Add</button>
        </div>

        <div class="section">
            <h3>ðŸ“‚ Filter Entries</h3>
            <button onclick="filterEntries()">Filter</button>
            <button onclick="exportToPDF()">ðŸ“„ Export to PDF</button>
            <ul id="resultList"></ul>
        </div>
    </div>

    <script>
        function getKey(category, letter) {
            return category + "_" + letter.toUpperCase();
        }

        function addEntry() {
            const category = document.getElementById("category").value;
            const letter = document.getElementById("alphabet").value;
            const word = document.getElementById("wordInput").value.trim();

            if (!word) return alert("Please enter a word/phrase.");

            const key = getKey(category, letter);
            let data = JSON.parse(localStorage.getItem(key)) || [];

            if (!data.includes(word)) {
                data.push(word);
                localStorage.setItem(key, JSON.stringify(data));
                alert("âœ… Added successfully!");
            } else {
                alert("âš ï¸ Word already exists in this category and letter.");
            }

            document.getElementById("wordInput").value = "";
        }

        function filterEntries() {
            const category = document.getElementById("category").value;
            const letter = document.getElementById("alphabet").value;
            const key = getKey(category, letter);
            let data = JSON.parse(localStorage.getItem(key)) || [];

            const list = document.getElementById("resultList");
            list.innerHTML = "";

            data.forEach((item, index) => {
                const li = document.createElement("li");

                const wordSpan = document.createElement("span");
                wordSpan.textContent = item;
                wordSpan.className = "word-text";
                wordSpan.title = "Click to see where this appears";
                wordSpan.onclick = () => showWordDetails(item);

                const deleteBtn = document.createElement("span");
                deleteBtn.textContent = "âŒ";
                deleteBtn.className = "delete-btn";
                deleteBtn.title = "Delete this word";
                deleteBtn.onclick = () => {
                    if (confirm(`Delete "${item}" from ${category.toUpperCase()} - ${letter}?`)) {
                        data.splice(index, 1);
                        localStorage.setItem(key, JSON.stringify(data));
                        filterEntries();
                    }
                };

                li.appendChild(wordSpan);
                li.appendChild(deleteBtn);
                list.appendChild(li);
            });
        }

        function showWordDetails(selectedWord) {
            const categories = ["vocab", "idioms", "ows"];
            const resultList = document.getElementById("resultList");
            resultList.innerHTML = "";

            let found = false;

            categories.forEach(category => {
                for (let i = 65; i <= 90; i++) {
                    const letter = String.fromCharCode(i);
                    const key = getKey(category, letter);
                    const data = JSON.parse(localStorage.getItem(key)) || [];

                    data.forEach(entry => {
                        if (entry.toLowerCase() === selectedWord.toLowerCase()) {
                            const li = document.createElement("li");
                            li.innerHTML = `<strong>${entry}</strong> in <em>${category.toUpperCase()}</em> [${letter}]`;
                            resultList.appendChild(li);
                            found = true;
                        }
                    });
                }
            });

            if (!found) {
                const li = document.createElement("li");
                li.textContent = "No matching entries found in any category.";
                resultList.appendChild(li);
            }
        }

        async function exportToPDF() {
            const category = document.getElementById("category").value;
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            let y = 10;

            doc.setFontSize(18);
            doc.text(`${category.toUpperCase()} Dictionary`, 105, y, { align: 'center' });
            y += 10;

            for (let i = 65; i <= 90; i++) {
                const letter = String.fromCharCode(i);
                const key = getKey(category, letter);
                let data = JSON.parse(localStorage.getItem(key)) || [];

                if (data.length > 0) {
                    doc.setFontSize(14);
                    doc.setTextColor(0, 0, 150);
                    y += 10;
                    if (y > 280) { doc.addPage(); y = 10; }
                    doc.text(`${letter}:`, 15, y);

                    doc.setFontSize(12);
                    doc.setTextColor(0, 0, 0);
                    const sorted = data.sort((a, b) => a.localeCompare(b));
                    let line = "";
                    sorted.forEach((word, idx) => {
                        line += word + (idx !== sorted.length - 1 ? ", " : "");
                    });

                    const splitLines = doc.splitTextToSize(line, 180);
                    splitLines.forEach(txt => {
                        y += 7;
                        if (y > 280) { doc.addPage(); y = 10; }
                        doc.text(txt, 20, y);
                    });
                }
            }

            doc.save(`${category}_Dictionary.pdf`);
        }
    </script>

</body>
</html>
